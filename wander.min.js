class wanderer{constructor(t,e,i,s,h,a,n="straight",{bound:r=!0,frameSpeed:g=2,waitTime:l={low:.1,high:.3},reAlingcheckSpeed:d=4,allowInner:c=!0,minimumWanderDistance:o=5,arcSpeed:u=.01,AngleDiffrence:w=50,Direction:m="positive"}={}){if(this.x=t,this.y=e,this.wanderRadius=i,this.baseX=s,this.baseY=h,this.speed=a,this.targetX=t+8*a,this.targetY=e+8*a,this.angle=.1,this.reachedTarget=!1,this.bound=r,this.frame=0,this.frameSpeed=g,this.waitTime=l,this.lastTime=Date.now(),this.locked=!1,this.reAlingcheckSpeed=d,this.wanderType=n,"straight"===this.wanderType)this.allowInner=c,this.allowInner&&(this.minimumWanderDistance=o);else if("arc"===this.wanderType)this.allowInner=!1,this.arcStartAngle=0,this.currentAngle=this.arcStartAngle,this.arcEndAngle=1,this.arcSpeed=u,this.AngleDiffrence=w*(Math.PI/180),this.Direction=m;else throw Error("wander type must be [arc] or [straight]")}#a(){this.locked=!0,setTimeout(()=>{this.angle=this.#b(),this.targetX=this.baseX,this.targetY=this.baseY,this.allowInner?this.allowInner&&(this.targetX+=this.#c(this.minimumWanderDistance,this.wanderRadius)*Math.cos(this.angle),this.targetY+=this.#c(this.minimumWanderDistance,this.wanderRadius)*Math.sin(this.angle)):(this.targetX+=this.wanderRadius*Math.cos(this.angle),this.targetY+=this.wanderRadius*Math.sin(this.angle)),"arc"===this.wanderType&&(this.arcEndAngle=this.angle),this.locked=!1},this.#d())}#b(){if("straight"===this.wanderType){let t=-Math.PI;return Math.random()*(Math.PI-t+1)+t}if("arc"===this.wanderType){var e=this.#c(this.AngleDiffrence,Math.PI-Math.PI%this.angle);if("positive"===this.Direction)return e=Math.abs(e),this.arcEndAngle=this.angle+e,console.log("currentAngle:",this.currentAngle,"angle:",this.angle,"plusminusangle:",e,"arcEndAngle:",this.angle+e,"Condition:",this.currentAngle<this.angle+e),this.angle+e;if("neutral"===this.Direction)return this.angle+e}}#e(){this.arcStartAngle=Math.atan2(this.baseY-this.y,this.baseX-this.x)}#d(){let i=this.waitTime.low;return(Math.random()*(this.waitTime.high-i+1)+i)*1e3}#c(s,h){return Math.random()*(h-s+1)+s}#f(a){return(a%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}#g(){!this.locked&&(Math.abs(this.currentAngle-this.arcEndAngle)<1.01*this.arcSpeed?this.#a():this.currentAngle<this.arcEndAngle?this.currentAngle+=this.arcSpeed:this.currentAngle>this.arcEndAngle&&(this.currentAngle-=this.arcSpeed))}#h(){this.locked||("straight"===this.wanderType?(this.x-=this.speed*Math.cos(this.angle),this.y-=this.speed*Math.sin(this.angle)):"arc"===this.wanderType&&(this.x=this.baseX+this.wanderRadius*Math.cos(this.currentAngle),this.y=this.baseY+this.wanderRadius*Math.sin(this.currentAngle)))}#i(){this.reachedTarget=Math.abs(this.x-this.targetX)<7*this.speed&&Math.abs(this.y-this.targetY)<7*this.speed&&!this.locked}#j(){this.angle=Math.atan2(this.y-this.targetY,this.x-this.targetX)}think(){this.#i(),"arc"===this.wanderType&&this.#g(),this.#h(),this.reachedTarget&&this.#a(),this.frame+=this.frameSpeed,this.frame%this.reAlingcheckSpeed&&"arc"!==this.wanderType&&this.#j()}returnXY(){return{x:this.x,y:this.y}}}
